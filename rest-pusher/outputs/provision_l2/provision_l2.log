---- mininet

student@ubuntu:~$ sudo mn --topo tree,3 --mac --controller 'remote,ip="127.0.0.1",port=6633' --switch ovsk,protocols=OpenFlow13
*** Creating network
*** Adding controller
*** Adding hosts:
h1 h2 h3 h4 h5 h6 h7 h8 
*** Adding switches:
s1 s2 s3 s4 s5 s6 s7 
*** Adding links:
(s1, s2) (s1, s5) (s2, s3) (s2, s4) (s3, h1) (s3, h2) (s4, h3) (s4, h4) (s5, s6) (s5, s7) (s6, h5) (s6, h6) (s7, h7) (s7, h8) 
*** Configuring hosts
h1 h2 h3 h4 h5 h6 h7 h8 
*** Starting controller
c0 
*** Starting 7 switches
s1 s2 s3 s4 s5 s6 s7 ...
*** Starting CLI:
mininet> 
mininet> 
mininet> 

---- initial state

mininet> pingall
*** Ping: testing ping reachability
h1 -> h2 h3 h4 h5 h6 h7 h8 
h2 -> h1 h3 h4 h5 h6 h7 h8 
h3 -> h1 h2 h4 h5 h6 h7 h8 
h4 -> h1 h2 h3 h5 h6 h7 h8 
h5 -> h1 h2 h3 h4 h6 h7 h8 
h6 -> h1 h2 h3 h4 h5 h7 h8 
h7 -> h1 h2 h3 h4 h5 h6 h8 
h8 -> h1 h2 h3 h4 h5 h6 h7 
*** Results: 0% dropped (56/56 received)
mininet> net
h1 h1-eth0:s3-eth1
h2 h2-eth0:s3-eth2
h3 h3-eth0:s4-eth1
h4 h4-eth0:s4-eth2
h5 h5-eth0:s6-eth1
h6 h6-eth0:s6-eth2
h7 h7-eth0:s7-eth1
h8 h8-eth0:s7-eth2
s1 lo:  s1-eth1:s2-eth3 s1-eth2:s5-eth3
s2 lo:  s2-eth1:s3-eth3 s2-eth2:s4-eth3 s2-eth3:s1-eth1
s3 lo:  s3-eth1:h1-eth0 s3-eth2:h2-eth0 s3-eth3:s2-eth1
s4 lo:  s4-eth1:h3-eth0 s4-eth2:h4-eth0 s4-eth3:s2-eth2
s5 lo:  s5-eth1:s6-eth3 s5-eth2:s7-eth3 s5-eth3:s1-eth2
s6 lo:  s6-eth1:h5-eth0 s6-eth2:h6-eth0 s6-eth3:s5-eth1
s7 lo:  s7-eth1:h7-eth0 s7-eth2:h8-eth0 s7-eth3:s5-eth2
c0

---- before provisioning

mininet> 
mininet> h1 ping h7
PING 10.0.0.7 (10.0.0.7) 56(84) bytes of data.
64 bytes from 10.0.0.7: icmp_seq=1 ttl=64 time=1.33 ms
64 bytes from 10.0.0.7: icmp_seq=2 ttl=64 time=0.137 ms
64 bytes from 10.0.0.7: icmp_seq=3 ttl=64 time=0.139 ms
64 bytes from 10.0.0.7: icmp_seq=4 ttl=64 time=0.138 ms
^C
--- 10.0.0.7 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3057ms
rtt min/avg/max/mdev = 0.137/0.438/1.338/0.519 ms

---- after provisioning

mininet> h1 ping h7
PING 10.0.0.7 (10.0.0.7) 56(84) bytes of data.
64 bytes from 10.0.0.7: icmp_seq=1 ttl=64 time=0.867 ms
64 bytes from 10.0.0.7: icmp_seq=1 ttl=64 time=24.6 ms (DUP!)
64 bytes from 10.0.0.7: icmp_seq=1 ttl=64 time=50.4 ms (DUP!)
64 bytes from 10.0.0.7: icmp_seq=1 ttl=64 time=72.6 ms (DUP!)
64 bytes from 10.0.0.7: icmp_seq=2 ttl=64 time=0.554 ms
64 bytes from 10.0.0.7: icmp_seq=2 ttl=64 time=5.11 ms (DUP!)
64 bytes from 10.0.0.7: icmp_seq=3 ttl=64 time=0.383 ms
64 bytes from 10.0.0.7: icmp_seq=4 ttl=64 time=0.064 ms
64 bytes from 10.0.0.7: icmp_seq=5 ttl=64 time=0.066 ms
64 bytes from 10.0.0.7: icmp_seq=6 ttl=64 time=0.072 ms
^C
--- 10.0.0.7 ping statistics ---
6 packets transmitted, 6 received, +4 duplicates, 0% packet loss, time 5056ms
rtt min/avg/max/mdev = 0.064/15.487/72.602/24.611 ms
mininet> h1 ping h7
PING 10.0.0.7 (10.0.0.7) 56(84) bytes of data.
64 bytes from 10.0.0.7: icmp_seq=1 ttl=64 time=0.062 ms
64 bytes from 10.0.0.7: icmp_seq=2 ttl=64 time=0.070 ms
64 bytes from 10.0.0.7: icmp_seq=3 ttl=64 time=0.063 ms
64 bytes from 10.0.0.7: icmp_seq=4 ttl=64 time=0.072 ms
64 bytes from 10.0.0.7: icmp_seq=5 ttl=64 time=0.140 ms
64 bytes from 10.0.0.7: icmp_seq=6 ttl=64 time=0.071 ms
64 bytes from 10.0.0.7: icmp_seq=7 ttl=64 time=0.082 ms
64 bytes from 10.0.0.7: icmp_seq=8 ttl=64 time=0.082 ms
64 bytes from 10.0.0.7: icmp_seq=9 ttl=64 time=0.063 ms
64 bytes from 10.0.0.7: icmp_seq=10 ttl=64 time=0.059 ms
64 bytes from 10.0.0.7: icmp_seq=11 ttl=64 time=0.082 ms
64 bytes from 10.0.0.7: icmp_seq=12 ttl=64 time=0.059 ms
64 bytes from 10.0.0.7: icmp_seq=13 ttl=64 time=0.083 ms
64 bytes from 10.0.0.7: icmp_seq=14 ttl=64 time=0.082 ms
64 bytes from 10.0.0.7: icmp_seq=15 ttl=64 time=0.081 ms
^C
--- 10.0.0.7 ping statistics ---
15 packets transmitted, 15 received, 0% packet loss, time 14324ms
rtt min/avg/max/mdev = 0.059/0.076/0.140/0.021 ms
mininet> 


---- ubuntu console

student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X POST http://localhost:8181/restconf/operations/vtn:update-vtn -d '{"input":{"tenant-name":"VTN_test"}}'
{"output":{"status":"CREATED"}}student@ubuntu:~$ 
student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X POST http://localhost:8181/restconf/operations/vtn-vbridge:update-vbridge -d '{"input":{"tenant-name":"VTN_test", "bridge-name":"VirtBr1"}}'
{"output":{"status":"CREATED"}}student@ubuntu:~$ 
student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X POST http://localhost:8181/restconf/operations/vtn-vinterface:update-vinterface -d '{"input":{"tenant-name":"VTN_test", "bridge-name":"VirtBr1", "interface-name":"int1"}}'
{"output":{"status":"CREATED"}}student@ubuntu:~$ 
student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X POST http://localhost:8181/restconf/operations/vtn-vinterface:update-vinterface -d '{"input":{"tenant-name":"VTN_test", "bridge-name":"VirtBr1", "interface-name":"int2"}}'
{"output":{"status":"CREATED"}}student@ubuntu:~$ 
student@ubuntu:~$ 
student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X POST http://localhost:8181/restconf/operations/vtn-port-map:set-port-map -d '{"input":{"tenant-name":"VTN_test", "bridge-name":"VirtBr1", "interface-name":"int1", "node":"openflow:3", "port-name":"s3-eth1"}}'
{"output":{"status":"CREATED"}}student@ubuntu:~$ 
student@ubuntu:~$ 
student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X POST http://localhost:8181/restconf/operations/vtn-port-map:set-port-map -d '{"input":{"tenant-name":"VTN_test", "bridge-name":"VirtBr1", "interface-name":"int1", "node":"openflow:7", "port-name":"s7-eth1"}}'
{"output":{"status":"CHANGED"}}student@ubuntu:~$ 
student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X POST http://localhost:8181/restconf/operations/vtn-port-map:set-port-map -d '{"input":{"tenant-name":"VTN_test", "bridge-name":"VirtBr1", "interface-name":"int1", "node":"openflow:3", "port-name":"s3-eth1"}}'
{"output":{"status":"CHANGED"}}student@ubuntu:~$ 
student@ubuntu:~$ 
student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X POST http://localhost:8181/restconf/operations/vtn-port-map:set-port-map -d '{"input":{"tenant-name":"VTN_test", "bridge-name":"VirtBr1", "interface-name":"int2", "node":"openflow:7", "port-name":"s7-eth1"}}'
{"output":{"status":"CREATED"}}student@ubuntu:~$ 
student@ubuntu:~$ 
student@ubuntu:~$ 
student@ubuntu:~$ curl --user "admin":"admin" -H "Content-type: application/json" -X GET http://localhost:8181/restconf/operational/vtn:vtns/
{"vtns":{"vtn":[{"name":"VTN_test","vtenant-config":{"hard-timeout":0,"idle-timeout":300},"vbridge":[{"name":"VirtBr1","bridge-status":{"state":"UP","path-faults":0},"vbridge-config":{"age-interval":600},"vinterface":[{"name":"int2","vinterface-config":{"enabled":true},"vinterface-status":{"state":"UP","mapped-port":"openflow:7:1","entity-state":"UP"},"port-map-config":{"node":"openflow:7","port-name":"s7-eth1","vlan-id":0}},{"name":"int1","vinterface-config":{"enabled":true},"vinterface-status":{"state":"UP","mapped-port":"openflow:3:1","entity-state":"UP"},"port-map-config":{"node":"openflow:3","port-name":"s3-eth1","vlan-id":0}}]}]}]}}student@ubuntu:~$ 
student@ubuntu:~$ 


---- switch tables
---- before

root@ubuntu:~# ovs-ofctl -O OpenFlow13 dump-flows s1
 cookie=0x2b00000000000035, duration=2448.179s, table=0, n_packets=980, n_bytes=83300, priority=100,dl_type=0x88cc actions=CONTROLLER:65535
 cookie=0x2b00000000000094, duration=2444.221s, table=0, n_packets=180, n_bytes=14772, priority=2,in_port="s1-eth1" actions=output:"s1-eth2",CONTROLLER:65535
 cookie=0x2b00000000000095, duration=2444.221s, table=0, n_packets=167, n_bytes=13834, priority=2,in_port="s1-eth2" actions=output:"s1-eth1",CONTROLLER:65535
 cookie=0x7f57ffffffffffff, duration=2448.175s, table=0, n_packets=27, n_bytes=3662, send_flow_rem priority=0 actions=CONTROLLER:65535

---- after

root@ubuntu:~# ovs-ofctl -O OpenFlow13 dump-flows s1
 cookie=0x2b00000000000035, duration=3407.112s, table=0, n_packets=1364, n_bytes=115940, priority=100,dl_type=0x88cc actions=CONTROLLER:65535
 cookie=0x7f56000000000001, duration=207.984s, table=0, n_packets=25, n_bytes=2282, send_flow_rem priority=10,in_port="s1-eth2",vlan_tci=0x0000/0x1fff,dl_src=00:00:00:00:00:07,dl_dst=00:00:00:00:00:01 actions=output:"s1-eth1"
 cookie=0x7f56000000000002, duration=207.104s, table=0, n_packets=23, n_bytes=2086, send_flow_rem priority=10,in_port="s1-eth1",vlan_tci=0x0000/0x1fff,dl_src=00:00:00:00:00:01,dl_dst=00:00:00:00:00:07 actions=output:"s1-eth2"
 cookie=0x2b00000000000094, duration=3403.154s, table=0, n_packets=218, n_bytes=20788, priority=2,in_port="s1-eth1" actions=output:"s1-eth2",CONTROLLER:65535
 cookie=0x2b00000000000095, duration=3403.154s, table=0, n_packets=206, n_bytes=19892, priority=2,in_port="s1-eth2" actions=output:"s1-eth1",CONTROLLER:65535
 cookie=0x7f57ffffffffffff, duration=3407.108s, table=0, n_packets=27, n_bytes=3662, send_flow_rem priority=0 actions=CONTROLLER:65535
